"use strict";var LAST_CHOSEN_CITY_KEY="_support_last_chosen_city";function findCity(e,t){return e.reduce((function(e,t){return e.concat(t.datas)}),[]).filter((function(e){return e.city===t}))[0]}var scrollbarWidth=null;function getScrollbarWidth(){if(scrollbarWidth)return scrollbarWidth;var e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=document.createElement("div");return e.appendChild(t),scrollbarWidth=e.offsetWidth-t.offsetWidth,e.parentNode.removeChild(e),scrollbarWidth}var dialog=createAddressDialog(OFFLINE_STORES,(function(e){renderStores(OFFLINE_STORES,e)}));function renderStores(e,t){var r=document.getElementById("stores"),n=findCity(e,t)||findCity(e,"上海");r.innerHTML=tmpl("stores-template",n),localStorage.setItem(LAST_CHOSEN_CITY_KEY,t),r.querySelector(".headline-content-change").onclick=function(){dialog.open(t)}}function createAddressDialog(e,t){var r,n=null;function o(){n.style.display="none",document.body.className="",document.body.style.paddingRight=null,r&&(r.style.right=0)}return{open:function(l){(n=n||function(n){var l=document.createElement("div");r=document.querySelector(".page-header-container"),l.innerHTML=tmpl("store-dialog-template",{list:e,current:n});var i=l.querySelector(".popbox-close-icon");return i&&(i.onclick=function(){o()}),l.onclick=function(e){var r=e.target.getAttribute("data-city");r&&(t(r),o())},document.body.appendChild(l),l}(l)).style.display="block",document.body.className="page-out-fbscroll",document.body.style.paddingRight=getScrollbarWidth()+"px",r&&(r.style.right=getScrollbarWidth()+"px")},close:o}}renderStores(OFFLINE_STORES,localStorage.getItem(LAST_CHOSEN_CITY_KEY));